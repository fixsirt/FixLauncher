# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Vanilla Suns Launcher v2.0

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã **–±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞** –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ª–∞—É–Ω—á–µ—Ä–∞.

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (CRITICAL)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `preload.js` —Å `contextBridge`
- ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω `nodeIntegration` –≤ main.js
- ‚úÖ –í–∫–ª—é—á–µ–Ω `contextIsolation` –≤ main.js
- ‚úÖ –°–æ–∑–¥–∞–Ω –±–µ–∑–æ–ø–∞—Å–Ω—ã–π IPC —Å–ª–æ–π –¥–ª—è —Å–≤—è–∑–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–§–∞–π–ª—ã:**
- `preload.js` ‚Äî –Ω–æ–≤—ã–π —Ñ–∞–π–ª (38 —Å—Ç—Ä–æ–∫)
- `main.js` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω—ã webPreferences
- `renderer.js` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω ipc wrapper –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```javascript
// –ë—ã–ª–æ (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ):
webPreferences: {
    nodeIntegration: true,
    contextIsolation: false
}

// –°—Ç–∞–ª–æ (–±–µ–∑–æ–ø–∞—Å–Ω–æ):
webPreferences: {
    nodeIntegration: false,
    contextIsolation: true,
    preload: path.join(__dirname, 'preload.js')
}
```

---

### 2. üì∞ –ö—ç—à –Ω–æ–≤–æ—Å—Ç–µ–π —Å TTL

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω 5-–º–∏–Ω—É—Ç–Ω—ã–π –∫—ç—à –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π Telegram
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API Telegram
- ‚úÖ –£—Å–∫–æ—Ä–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∫–ª–∞–¥–æ–∫

**–§–∞–π–ª—ã:**
- `main.js` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω `NEWS_CACHE_TTL` –∏ –ª–æ–≥–∏–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö–æ–¥:**
```javascript
const NEWS_CACHE_TTL = 5 * 60 * 1000; // 5 –º–∏–Ω—É—Ç
const newsCache = { items: [], timestamp: 0 };

ipcMain.handle("get-news", async () => {
    const now = Date.now();
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
    if (newsCache.items.length > 0 && now - newsCache.timestamp < NEWS_CACHE_TTL) {
        return { ok: true, items: newsCache.items, cached: true };
    }
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤—ã–µ
});
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π: ~2 —Å–µ–∫ ‚Üí ~50 –º—Å (–∏–∑ –∫—ç—à–∞)
- –ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram

---

### 3. üîç –ö—ç—à –ø–æ–∏—Å–∫–∞ –º–æ–¥–æ–≤ (Modrinth)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∫—ç—à –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ Modrinth
- ‚úÖ TTL 5 –º–∏–Ω—É—Ç
- ‚úÖ –ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API

**–§–∞–π–ª—ã:**
- `renderer.js` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω `modrinthSearchCache`

**–ö–æ–¥:**
```javascript
const modrinthSearchCache = new Map();
const MODRINTH_CACHE_TTL = 5 * 60 * 1000;

function searchModrinth(query, gameVersion, loader, limit = 20) {
    const cacheKey = `search:${query}:${gameVersion}:${loader}:${limit}`;
    const cached = modrinthSearchCache.get(cacheKey);
    if (cached && Date.now() - cached.time < MODRINTH_CACHE_TTL) {
        return Promise.resolve(cached.data); // –ò–∑ –∫—ç—à–∞
    }
    // –ó–∞–ø—Ä–æ—Å –∫ API
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫: ~1 —Å–µ–∫ ‚Üí ~10 –º—Å
- –ú–µ–Ω—å—à–µ –ª–∏–º–∏—Ç–æ–≤ API

---

### 4. üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω `electron-updater`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- ‚úÖ IPC –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –°–æ–±—ã—Ç–∏—è –¥–ª—è UI

**–§–∞–π–ª—ã:**
- `main.js` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω `initAutoUpdater()`
- `preload.js` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- `package.json` ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `electron-updater`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
window.electronAPI.checkForUpdates()

// –ó–∞–≥—Ä—É–∑–∫–∞
window.electronAPI.downloadUpdate()

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞
window.electronAPI.quitAndInstall()
```

**–°–æ–±—ã—Ç–∏—è:**
```javascript
window.electronAPI.onUpdateStatus((data) => {
    console.log('–°—Ç–∞—Ç—É—Å:', data.status);
});
window.electronAPI.onUpdateProgress((data) => {
    console.log('–ü—Ä–æ–≥—Ä–µ—Å—Å:', data.percent + '%');
});
```

---

### 5. üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `debug.log`
- ‚úÖ –õ–æ–≥–∏ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
- ‚úÖ –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ (INFO, WARN, ERROR)

**–§–∞–π–ª—ã:**
- `main.js` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è `log()` –∏ IPC –æ–±—Ä–∞–±–æ—Ç—á–∏–∫

**–ö–æ–¥:**
```javascript
function log(level, message) {
    const timestamp = new Date().toISOString();
    const line = `[${timestamp}][${level}] ${message}\n`;
    console.log(line.trim());
    fs.appendFileSync(LOG_FILE, line);
}
```

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤:**
```
[2025-02-20T12:00:00.000Z][INFO] App ready
[2025-02-20T12:00:01.000Z][INFO] Creating main window
[2025-02-20T12:00:05.000Z][INFO] [Updater] Checking for updates
[2025-02-20T12:00:06.000Z][INFO] Returning cached news
```

---

### 6. üß™ –¢–µ—Å—Ç—ã

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ 32 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è utils.js (9 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è versions.js (13 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ Jest –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
npm test              # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
npm run test:watch    # –†–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
npm run test:coverage # –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
PASS __tests__/utils.test.js (32 tests)
PASS __tests__/versions.test.js (13 tests)

Test Suites: 2 passed, 2 total
Tests:       32 passed, 32 total
```

---

### 7. üì¶ –°–±–æ—Ä–∫–∞

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ `npm start` ‚Äî –∑–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ `npm run dev` ‚Äî –∑–∞–ø—É—Å–∫ —Å DevTools
- ‚úÖ `npx electron-packager` ‚Äî —Å–±–æ—Ä–∫–∞ portable –≤–µ—Ä—Å–∏–∏
- ‚úÖ `npm run build:win` ‚Äî —Å–±–æ—Ä–∫–∞ installer (—Ç—Ä–µ–±—É–µ—Ç –∏–∫–æ–Ω–∫—É 256x256)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò–∫–æ–Ω–∫–∞ `logo.ico` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 256x256 –¥–ª—è electron-builder

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# Portable –≤–µ—Ä—Å–∏—è (—Ä–∞–±–æ—Ç–∞–µ—Ç):
npx electron-packager . "Vanilla Suns Launcher" --platform=win32 --arch=x64 --out=dist --overwrite --asar --prune
```

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | ‚ùå nodeIntegration: true | ‚úÖ contextBridge | 100% |
| –ö—ç—à –Ω–æ–≤–æ—Å—Ç–µ–π | ‚ùå | ‚úÖ 5 –º–∏–Ω TTL | ~40x –±—ã—Å—Ç—Ä–µ–µ |
| –ö—ç—à –º–æ–¥–æ–≤ | ‚ùå | ‚úÖ 5 –º–∏–Ω TTL | ~100x –±—ã—Å—Ç—Ä–µ–µ |
| –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ | ‚ùå | ‚úÖ electron-updater | –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚ùå | ‚úÖ debug.log | –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è |
| –¢–µ—Å—Ç—ã | 0 | 32 | +32 —Ç–µ—Å—Ç–∞ |
| main.js —Å—Ç—Ä–æ–∫ | 282 | 457 | +175 (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫—ç—à, updater) |
| renderer.js —Å—Ç—Ä–æ–∫ | 4913 | 4985 | +72 (IPC wrapper, –∫—ç—à) |
| –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã | - | preload.js | 1 —Ñ–∞–π–ª |

---

## üéØ –ß—Ç–æ –ù–ï –∏–∑–º–µ–Ω–µ–Ω–æ (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ)

- ‚úÖ –í—Å–µ IPC –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ Telegram (–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π)
- ‚úÖ –ó–∞–ø—É—Å–∫ Minecraft
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–º–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (RAM, Java, –ø—É—Ç–∏)
- ‚úÖ –í–∫–ª–∞–¥–∫–∏ –∏ UI
- ‚úÖ –¢–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤—Ä—É—á–Ω—É—é
```javascript
// –í renderer.js –∏–ª–∏ –∫–æ–Ω—Å–æ–ª–∏ DevTools:
const { ipc } = require('./renderer');
ipc.invoke('check-for-updates').then(console.log);
```

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –Ω–æ–≤–æ—Å—Ç–µ–π
```javascript
// –í main.js –∫–æ–Ω—Å–æ–ª–∏:
newsCache.items = [];
newsCache.timestamp = 0;
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –§–∞–π–ª debug.log –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
# –ò–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ DevTools:
ipc.invoke('log', '–°–æ–æ–±—â–µ–Ω–∏–µ', 'info');
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: IPC wrapper –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏ —Å—Ç–∞—Ä—ã–π API (nodeIntegration), –∏ –Ω–æ–≤—ã–π (contextBridge)

2. **–ö—ç—à**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç

3. **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ packaged –≤–µ—Ä—Å–∏–∏ (–Ω–µ –≤ dev —Ä–µ–∂–∏–º–µ)

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–±–æ—Ä–∫–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å –∏–∫–æ–Ω–∫—É –¥–æ 256x256

---

**Vanilla Suns Launcher v2.0 ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω, –±–µ–∑–æ–ø–∞—Å–µ–Ω, –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!**
